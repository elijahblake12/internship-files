<!DOCTYPE html>
<html>

<head>
  <!--css and js from leaflet for map--> 

  <link rel="stylesheet" href="leaflet/leaflet.css" />
  <script src="leaflet/leaflet.js"></script> 

  <!--css and js from ersi for geocoding-->
  <script src="https://unpkg.com/esri-leaflet"></script>


  <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder/dist/esri-leaflet-geocoder.css">
  <script src="https://unpkg.com/esri-leaflet-geocoder"></script>

  <meta charset="utf-8">
  <title>Map</title>

  <style>
    #mapid {
      height: 700px;
    }
  </style>
</head>

<body>

  <div id="mapid"></div>

  <script>
    //creates map
  var map = L.map('mapid').setView([50, -100], 3);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
      maxZoom: 18,
      id: 'mapbox.streets',
      accessToken: 'pk.eyJ1IjoiZWxpamFoYmxha2UxMiIsImEiOiJjanhjbGtrejAwNG5vM3Vwa2o2bWJ6emJlIn0.Rilbj3JdmmYvWqenu3eFLQ'
    }).addTo(map);
    //data for zip codes
    var zips = [{ zip_code: 83854, count: 3 }, { zip_code: 59715, count: 5 }, { zip_code: 94303, count: 2 }, { zip_code: 99501, count: 1 }, { zip_code: 00901, count: 4 }, { zip_code: 96795, count: 9 }];

    //function for plotting points
    function plotPoint(zip_code, countOfPoints) {
      L.esri.Geocoding.geocode().postal(zip_code).run(function (err, results, response) {
        var marker = L.marker([results.results[0].latlng.lat, results.results[0].latlng.lng]).bindTooltip(countOfPoints.toString(), { permanent: true, direction: 'left' }).addTo(map);
      });
    }

    //loops through zip code data and plots points

    for (var i = 0; i < zips.length; i++) {
      plotPoint(zips[i].zip_code, zips[i].count);
    }

  </script>

</body>

</html>